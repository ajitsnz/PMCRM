!function(e){var t={};function a(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(r,s,function(t){return e[t]}.bind(null,s));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=54)}({54:function(e,t,a){e.exports=a("PF+v")},"PF+v":function(e,t,a){"use strict";$(document).ready((function(){function e(e){$.ajax({url:customerURL,type:"GET",data:{customer_id:e},success:function(e){if(e.success&&!isEmpty(e.data)){var t=e.data;$("#address_to").empty(),$("#address_to").append("<span>"+t.street+",</span><br>"),$("#address_to").append("<span>"+t.city+", </span>"),$("#address_to").append("<span>"+t.state+",</span><br>"),$("#address_to").append("<span>"+t.country+" - </span>"),$("#address_to").append("<span>"+t.zip+"</span>"),$("#addressStreet").val(e.data.street),$("#addressCity").val(e.data.city),$("#addressState").val(e.data.state),$("#addressZipCode").val(e.data.zip),$("#addressCountry").val(e.data.country)}},error:function(e){displayErrorMessage(e.responseJSON.message)}})}$(".datepicker").datetimepicker({format:"YYYY-MM-DD HH:mm:ss",useCurrent:!1,sideBySide:!0,maxDate:new Date,icons:{up:"fa fa-chevron-up",down:"fa fa-chevron-down",next:"fa fa-chevron-right",previous:"fa fa-chevron-left"}}),$(".due-datepicker").datetimepicker({format:"YYYY-MM-DD HH:mm:ss",useCurrent:!1,sideBySide:!0,icons:{up:"fa fa-chevron-up",down:"fa fa-chevron-down",next:"fa fa-chevron-right",previous:"fa fa-chevron-left"}}),setTimeout((function(){1==editData&&""!==$(".due-datepicker").val()?$(".due-datepicker").data("DateTimePicker").minDate($(".due-datepicker").val()):$(".due-datepicker").data("DateTimePicker").minDate(moment().millisecond(0).second(0).minute(0).hour(0))}),1e3),$("#proposalCurrencyId").select2({width:"100%",placeholder:"Select Currency"}),$("#discountTypeSelect").select2({width:"100%",placeholder:"Select Discount Type"}),$(".related-select-box").select2({width:"100%",placeholder:"Select Option"}),$(".assigned-select-box").select2({width:"100%",placeholder:"Select Member"}),$(".currency-select-box").select2({width:"100%",placeholder:"Select Currency"}),$(".status-select-box").select2({width:"100%"}),$("#leadOwnerId").select2({width:"100%",placeholder:"Select Lead"}),$("#customerSelectBox").select2({width:"100%",placeholder:"Select Customer"}),$(".ownerid-select-box").prop("disabled",!0),setTimeout((function(){""!==$("#relatedToId").val()&&$("#relatedToId").val($("#relatedToId").val()).trigger("change")}),500),$(document).on("change",".related-select-box",(function(){var t=$(this).val();if($(".ownerid-select-box").prop("disabled",!0),$(".related-to-field1, .related-to-field2").hide(),t>0&&($(".related-to-field"+t).show(),$(".related-to-field"+t+" .ownerid-select-box").prop("disabled",!1)),1==t&&($("#address_to").html("_ _ _ _ _ _"),$("#addressStreet,#addressCity,#addressState,#addressZipCode,#addressCountry").val("")),2==t){var a=$("#customerSelectBox").val();isEmpty(a)||e(a)}})),$(document).on("keyup",".phone",(function(){$(this).val($(this).val().replace(/[^0-9.]/g,"").replace(/(\..*)\./g,"$1"))})),$("#addItemSelectBox").on("select2:select",(function(){var e=$(this).val();$.ajax({url:itemUrl+"/"+e+"/edit",type:"GET",success:function(e){""!==$(".items-container>tr:last-child").find(".item-name").val()&&$("#itemAddBtn").trigger("click");var t=$(".items-container>tr:last-child"),a=document.createElement("textarea");a.innerHTML=e.data.title,t.find(".item-name").val(a.value),t.find(".item-description").val($(e.data.description).text()),t.find(".qty").val("1").trigger("keyup"),t.find(".rate").val(e.data.rate).trigger("keyup");var r=[];e.data.first_tax&&r.push(e.data.first_tax.id),e.data.second_tax&&r.push(e.data.second_tax.id),t.find(".tax-rates").val(r).trigger("change")}})})),$(document).on("click","#saveAsDraft, #saveAndSend",(function(e){var t=$(this).data("status");if(""!==$("#error-msg").text())return $("#phoneNumber").focus(),!1;e.preventDefault();var a=document.getElementById("proposalForm"),r=new FormData(a);r.append("status",t);var s,d,n,o,i,c,l,p,u=0,f=[];c=$(".total-numbers").text(),$(".items-container>tr").each((function(){f=[],s=$(this).find(".item-name").val(),d=$(this).find(".item-description").val(),n=$(this).find(".qty").val(),o=$(this).find(".rate").val(),i=$(this).find(".item-amount").text(),$.each($($(this).find(".tax-rates option:selected")),(function(){f.push($(this).val())})),r.append("itemsArr["+u+"][item]",s),r.append("itemsArr["+u+"][description]",d),r.append("itemsArr["+u+"][quantity]",n),r.append("itemsArr["+u+"][rate]",o),r.append("itemsArr["+u+"][total]",i),r.append("itemsArr["+u+"][tax]",f),u++})),$("#taxesListTable>tr").each((function(){l=(l=$(this).find(".tax-value").text()).replace("%",""),p=$(this).find(".footer-tax-numbers").text(),r.append("taxes["+l+"]",p)})),r.append("total_amount",c),r.append("sub_total",$("#subTotal").text()),$.ajax({url:proposalStoreURL,type:"POST",data:r,processData:!1,contentType:!1,beforeSend:function(){startLoader()},success:function(e){if(e.success){var t=e.data.id;window.location=proposalUrl+"/"+t}},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){stopLoader()}})})),$(document).on("click","#editSaveSend",(function(e){var t=$(this).data("status");if(""!==$("#error-msg").text())return $("#phoneNumber").focus(),!1;e.preventDefault();var a=document.getElementById("editProposalForm"),r=new FormData(a);r.append("status",t);var s,d,n,o,i,c,l,p,u=0,f=[];c=$(".total-numbers").text(),$(".items-container>tr").each((function(){f=[],s=$(this).find(".item-name").val(),d=$(this).find(".item-description").val(),n=$(this).find(".qty").val(),o=$(this).find(".rate").val(),i=$(this).find(".item-amount").text(),$.each($($(this).find(".tax-rates option:selected")),(function(){f.push($(this).val())})),r.append("itemsArr["+u+"][item]",s),r.append("itemsArr["+u+"][description]",d),r.append("itemsArr["+u+"][quantity]",n),r.append("itemsArr["+u+"][rate]",o),r.append("itemsArr["+u+"][total]",i),r.append("itemsArr["+u+"][tax]",f),u++})),$("#taxesListTable>tr").each((function(){l=(l=$(this).find(".tax-value").text()).replace("%",""),p=$(this).find(".footer-tax-numbers").text(),r.append("taxes["+l+"]",p)})),r.append("total_amount",c),r.append("sub_total",$("#subTotal").text());var m=$("#hdnProposalId").val();$.ajax({url:proposalEditURL+"/"+m,type:"POST",data:r,processData:!1,contentType:!1,beforeSend:function(){startLoader()},success:function(e){if(e.success){var t=e.data.id;window.location=proposalEditURL+"/"+t}},error:function(e){displayErrorMessage(e.responseJSON.message)},complete:function(){stopLoader()}})})),"undefined"!=typeof proposalEdit&&proposalEdit&&($(".related-select-box").trigger("change"),$(".tax-rates").trigger("change"),$(".qty").trigger("keyup"),$("#adjustment").trigger("keyup"),window.calculateSubTotal()),$(".address-modal").on("show.bs.modal",(function(){setTimeout((function(){$("#addressStreet").focus()}),500)})),window.checkAddressFields=function(){return $("#addressStreet,#addressCity,#addressState,#addressZipCode,#addressCountry").filter((function(){return""!=this.value}))},window.showAddressError=function(e){$(".address-modal").modal("show"),displayErrorMessage($(e).data("err-msg"))},window.checkStreetField=function(){return""!==$.trim($("#addressStreet").val())||(showAddressError("#addressStreet"),!1)},$(document).on("click","#btnSaveAddress",(function(){if(!checkStreetField())return!1;if(!checkZipcode($("#addressZipCode").val()))return!1;var e=$("#addressForm");"undefined"!=typeof createProposalAddress&&createProposalAddress&&(0==checkAddressFields().length?$("#address_to").html("_ _ _ _ _ _"):$("#address_to").html(createAddressDetail(e))),"undefined"!=typeof editProposalAddress&&editProposalAddress&&(0==checkAddressFields().length?$("#address_to").html("_ _ _ _ _ _"):$("#address_to").html(getAddressDetail(e))),$(".address-modal").modal("hide")})),$(document).on("change","#customerSelectBox",(function(){var t=$(this).val();isEmpty(t)||e(t)}))}))}});